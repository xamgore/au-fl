## 1

> Доказать или опровергнуть регулярность языка натуральных чисел в десятичной системе без лидирующих нулей, деляющихся на $4$ и имеющих сумму цифр, равную $2$.

Поанализируем язык:

1. Если сумма цифр равна $2$, то $\Sigma = \{ 0, 1, 2 \}$
2. Если делится на $4$ $\Rightarrow$ делится на $2$ $\Rightarrow$ последняя цифра — либо $0$, либо $2$.
    * Слово `2` не подходит, так как не делится на $4$
    * Слова вида `...2` не подходят, так как слева от двойки могут стоять только нули (чтобы не нарушить сумму = $2$), но и не может быть лидирующих нулей
    * Из этого следует, что если двойка принадлежит слову, то справа от неё стоят нули, т.е. `20+` принадлежат языку: сумма равна $2$, слева нет лидирующих нулей, делятся на 4
3. Если $2$ не в составе слова, то там находятся две единицы (чтобы не нарушить сумму = $2$).
    * Слева от $1$ нет лидирующих нулей $\Rightarrow$ слова вида `1...`
    * Слово не может быть вида `10*1`, `10*10`, потому что не делятся на $4$. Слово вида `10*10*00` делятся на $4$, потому что в конце слова два нуля.
4. Других слов нет, так как мы использовали все предикаты.

Ясно, что такой язык можно описать с помощью регулярного выражения:
`20+ | 10*100+` $\Rightarrow$ он регулярный.

## 2

> Построить регулярную грамматику, задающую язык $ L = \{ \alpha \cdot a b a \cdot \beta \mid \alpha, \beta \in \{ a, b \}^* \} \cup \{ \alpha \cdot b a b \cdot \beta \mid \alpha, \beta \in \{ a, b \}^* \} $

По сути нас интересует язык, описываемый регулярным выражением $[ab]^{* }(aba\ |\ bab)[ab]^{* }$

Построим ДКА, соответствующий языку.

<img src="./auto2.png" width="400"/>

Теперь осталось перевести из автомата в грамматику:

$S\ \ \to aA_1\ |\ bB_1$
$A_1 \to bA_2\ |\ aA_1$
$A_2 \to aF\ \ \,|\ bB_1$
$B_1 \to aB_2\ |\ bB_1$
$B_2 \to bF\ \ \ |\ aA_1$
$F\ \ \to a\ |\ b\ |\ aF\ |\ bF$


## 3

> Проверить регулярность языка $L = \{ 0^{|\omega|} \cdot \omega \mid \omega \in \{ 0, 1, \dots, 9 \}^* \} $

Этот язык выглядит очень подозрительно: по сути нам нужно запомнить, сколько нулей мы записали, а потом потратить эти нули на $\omega.$ Поэтому этот язык похож на контекстно-свободный, и в принципе понятно, как грамматику написать. Можно проверить по [лемме о накачке](https://ru.wikipedia.org/wiki/%D0%9B%D0%B5%D0%BC%D0%BC%D0%B0_%D0%BE_%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D1%81%D1%82%D0%B0%D0%BD%D0%B8%D0%B8#%D0%9E%D0%B1%D1%80%D0%B0%D1%82%D0%BD%D0%B0%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D1%83%D0%BB%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0), но она неюзабельна вообще никак, поэтому <i>воспользуемся ей</i>.

$\forall n\in \mathbb {N}\colon\ \exists \alpha \in L,\ |\alpha |\geqslant n$ и $\forall u,v,w\in V^{* }\colon\ \alpha =uvw\land |v|\geqslant 1\ \land |uv|\leqslant n$, что $(\exists i\in \mathbb {N} \cup \{0\})\ uv^{i}w\not \in L$

Перефразируем: для каждого $n \in \mathbb{N}$, найти такое слово длины $n$ (префикс в нём может быть пустым), что при "накачке" середины $v$, получится слово не из языка.

Для фиксированного $n$ предъявим слово $\alpha = 0^{|7^n|}\cdot 7^n = 0^n\cdot 7^n$. Пусть $\alpha$ как-то разбили на $u, v, w$:

$$\underbrace{0_10_2..0}_{\text{u}}\,\underbrace{00..0_{k}}_{v}\,\underbrace{00..0_n\,7_17_2..7_n}_{w}$$

Где $1 \leqslant k \leqslant n$. Соответственно $w = 0^{n-k}\,7^n$, а всё слово $\alpha = \underbrace{0^k}_{uv}\,\underbrace{0^{n-k}\,7^n}_{w}.$ Запишем соотношение, которое выполняется тогда и только тогда, когда слово принадлежит языку:

$$ \underbrace{k + (n - k)}_{\text{zeros}} = \underbrace{n}_{\text{sevens}} $$

Ясно, что если дублировать $v$, состоящее хотя бы из одного нуля, то левая часть этого соотношения станет больше правой хотя бы на единицу. Таким образом $uv^2w$ не будет принадлежать языку $L$. Следовательно язык не является регулярным.

## 4

> Построить недетерминированный автомат по регулярному выражению $ a\ |\ (ba\ |\ bb)^* $, построить эпсилон-замыкание автомата

Построим $\varepsilon$-НКА согласно [теореме Клини](https://neerc.ifmo.ru/wiki/index.php?title=%D0%A2%D0%B5%D0%BE%D1%80%D0%B5%D0%BC%D0%B0_%D0%9A%D0%BB%D0%B8%D0%BD%D0%B8_(%D1%81%D0%BE%D0%B2%D0%BF%D0%B0%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%BE%D0%B2_%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%BD%D1%8B%D1%85_%D0%B8_%D1%80%D0%B5%D0%B3%D1%83%D0%BB%D1%8F%D1%80%D0%BD%D1%8B%D1%85_%D1%8F%D0%B7%D1%8B%D0%BA%D0%BE%D0%B2)). Правда, здесь я немного ленюсь и между последовательными символами не ставлю $\varepsilon$-переходы.

<img src="auto42.png" width="400">

Найдём $\varepsilon$-замыкание и минимизируем:

<img src="auto43.png" width="170">


## 5

> Построить недетерминированный автомат по регулярному выражению $ (a\ |\ ab)^{* }\ |\ b $, построить эпсилон-замыкание автомата

<img src="auto5.png" width="400">

Построим $\varepsilon$-замыкание:

<img src="auto52.png" width="190">

## 6

Расширить язык $L$ следующими конструкциями, модифицировать лексер и описание конкретного синтаксиса
  * `**` — возведение в степень. Убедитесь, что токенизация умножения все еще работает.
  * Многострочные комментарии. Выбрать стратегию обработки вложенных многострочных комментариев.

Репозиторий обновлён: директория [task03](https://github.com/xamgore/au-fl/tree/master/task03).
